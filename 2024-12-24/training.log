Revised previous topics. Update the bayut code to improve speed.